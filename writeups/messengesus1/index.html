<!DOCTYPE html>
<html lang="en"><head>

  
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="">  


  
  <meta property="og:type" content="website">
  <meta property="og:description" content="" />
  <meta property="og:image" content="https://wepfen.github.io//images/avatar.png" />
  <meta property="og:url" content="https://wepfen.github.io/writeups/messengesus1/">
  <meta property="og:title" content="BraekerCTF 2024 - Messengesus 1 [crypto]">
  <meta property="og:site_name" content="wepfen.github.io">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta property="twitter:domain" content="wepfen.github.io">
  <meta property="twitter:url" content="https://wepfen.github.io/writeups/messengesus1/">
  <meta name="twitter:title" content="BraekerCTF 2024 - Messengesus 1 [crypto]">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="https://wepfen.github.io//images/avatar.png">
  
  <title>
    
      BraekerCTF 2024 - Messengesus 1 [crypto]
    
  </title>


  <link rel="icon" type="image/gif" href="/images/oia-uia.gif" />
   

  
  
  
  
  <link rel="stylesheet" href="/css/main.9bb372a616563f9ecafd6e5ea0d7760c487f35e7358f212b258b477fbfa75f5264ef33aaffa0334383ffc444b631b8dc5c496c67b5830ab2ac1f1e226a1125c3.css" integrity="sha512-m7NyphZWP57K/W5eoNd2DEh/Nec1jyErJYtHf7&#43;nX1Jk7zOq/6AzQ4P/xES2MbjcXElsZ7WDCrKsHx4iahElww==" />

  


</head>

    <body a="dark">
        <main class="page-content" aria-label="Content">
            <div class="w">
<a href="/">~/</a>




<script src="/js/theme-toggle.f10bb0c6283b259e63664053a20ccc48c8b0980e44bceece1c10401c529c2040.js" integrity="sha256-8Quwxig7JZ5jZkBTogzMSMiwmA5EvO7OHBBAHFKcIEA="></script>

<button style="float: right; background: none; outline: none;" onclick="toggleTheme()">

<svg class="w-6 h-6 text-gray-800 dark:text-white theme" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
  <path fill-rule="evenodd" d="M7.05 4.05A7 7 0 0 1 19 9c0 2.407-1.197 3.874-2.186 5.084l-.04.048C15.77 15.362 15 16.34 15 18a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1c0-1.612-.77-2.613-1.78-3.875l-.045-.056C6.193 12.842 5 11.352 5 9a7 7 0 0 1 2.05-4.95ZM9 21a1 1 0 0 1 1-1h4a1 1 0 1 1 0 2h-4a1 1 0 0 1-1-1Zm1.586-13.414A2 2 0 0 1 12 7a1 1 0 1 0 0-2 4 4 0 0 0-4 4 1 1 0 0 0 2 0 2 2 0 0 1 .586-1.414Z" clip-rule="evenodd"/>
</svg>

</button>






<article>
    <p class="post-meta">
        <time datetime="2024-03-03 12:17:53 &#43;0100 CET">
            2024-03-03
        </time>
    </p>

    <h1>BraekerCTF 2024 - Messengesus 1 [crypto]</h1>

    
        <aside >
            <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a>
      <ul>
        <li><a href="#source-code">Source code</a></li>
      </ul>
    </li>
    <li><a href="#recon">Recon</a></li>
    <li><a href="#solve">Solve</a></li>
  </ul>
</nav>
        </aside>
    

    <h1 id="introduction">Introduction</h1>
<blockquote>
<p>Difficulty : Easy</p>
</blockquote>
<blockquote>
<p>Team : Crampting</p>
</blockquote>
<blockquote>
<p><a href="https://github.com/spipm/BraekerCTF_2024_public/tree/main/challenges/crypto-hashcracking/messengesus">Source files</a></p>
</blockquote>
<blockquote>
<p>You encounter a bot meditating in the park. He opens his cameras and begins to speak.</p>
<p>&ldquo;Hear the word of RNGesus. Complexity is the enemy of security. Let your encryption be as simple as possible, as to secure it, thusly&rdquo;. He hands you a flyer with a snippet of code. &ldquo;Secure every message you have with it. Only those who see can enter.&rdquo;</p>
<p>What do you think? Is it simple enough to be secure?</p>
</blockquote>
<h2 id="source-code">Source code</h2>
<div class="highlight"><div style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#e67e80">#include</span> <span style="color:#e67e80;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#e67e80">
</span></span></span><span style="display:flex;"><span><span style="color:#e67e80">#include</span> <span style="color:#e67e80;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#e67e80">
</span></span></span><span style="display:flex;"><span><span style="color:#e67e80">#include</span> <span style="color:#e67e80;font-style:italic">&lt;string.h&gt;</span><span style="color:#e67e80">
</span></span></span><span style="display:flex;"><span><span style="color:#e67e80"></span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#dbbc7f">int</span> <span style="color:#b2c98f">main</span>() {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#dbbc7f">char</span> secret[] <span style="color:#7a8478">=</span> <span style="color:#b2c98f">&#34;brck{not_the_flag}&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#dbbc7f">char</span> <span style="color:#7a8478">*</span>key <span style="color:#7a8478">=</span> <span style="color:#d699b6">NULL</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#dbbc7f">size_t</span> read_length, buffer_length <span style="color:#7a8478">=</span> <span style="color:#d699b6">0</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#859289;font-style:italic">// Read One Time Key
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"></span>    FILE <span style="color:#7a8478">*</span>random_bytes <span style="color:#7a8478">=</span> <span style="color:#b2c98f">fopen</span>(<span style="color:#b2c98f">&#34;/dev/urandom&#34;</span>, <span style="color:#b2c98f">&#34;r&#34;</span>); <span style="color:#859289;font-style:italic">//incassable comme d&#39;hab
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"></span>    read_length <span style="color:#7a8478">=</span> <span style="color:#b2c98f">getline</span>(<span style="color:#7a8478">&amp;</span>key, <span style="color:#7a8478">&amp;</span>buffer_length, random_bytes); 
</span></span><span style="display:flex;"><span>    <span style="color:#b2c98f">fclose</span>(random_bytes); 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#859289;font-style:italic">// Encrypt
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"></span>    <span style="color:#e67e80">for</span> (<span style="color:#dbbc7f">int</span> i <span style="color:#7a8478">=</span> <span style="color:#d699b6">0</span>; i <span style="color:#7a8478">&lt;</span> <span style="color:#b2c98f">strlen</span>(secret); i<span style="color:#7a8478">++</span>)
</span></span><span style="display:flex;"><span>        secret[i] <span style="color:#7a8478">=</span> secret[i] <span style="color:#7a8478">^</span> key[i<span style="color:#7a8478">%</span>read_length];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#859289;font-style:italic">// Return encrypted secret
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"></span>    <span style="color:#b2c98f">printf</span>(<span style="color:#b2c98f">&#34;%s&#34;</span>, secret);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#b2c98f">free</span>(key);
</span></span><span style="display:flex;"><span>    <span style="color:#e67e80">return</span> <span style="color:#d699b6">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="recon">Recon</h1>
<p>Reading man for <code>getline()</code> (thanks to <a href="https://github.com/spipm">admin</a> adivce), we understand that getline take bytes from a file until a <code>\n</code> or 0x0A bytes is encoutered.</p>
<p>So each time we connect to the server we got a ciphertext xored with a key from <code>/dev/urandom</code> and it&rsquo;s length can vary it only depends of the presence of <code>0x0A</code> bytes. So the key can have a length of 1 or even 500.</p>
<p>The solution is to request a server until the key is short enoguh, (1 or 2 bytes).</p>
<p>And we can know that by xoring 1st character of the known plaintext which is <code>'b'</code> from <code>'brck{'</code> and comparing it with the xor of the 2nd known character with the 2nd character of the ciphertext.</p>
<h1 id="solve">Solve</h1>
<div class="highlight"><div style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">55
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#e67e80">from</span> pwn <span style="color:#e67e80">import</span> <span style="color:#7a8478">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>host <span style="color:#7a8478">=</span> <span style="color:#b2c98f">&#39;0.cloud.chals.io&#39;</span>
</span></span><span style="display:flex;"><span>port <span style="color:#7a8478">=</span> <span style="color:#d699b6">26265</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#7a8478">=</span> <span style="color:#b2c98f">b</span><span style="color:#b2c98f">&#39;&#39;</span> <span style="color:#859289;font-style:italic"># known plaintext 1</span>
</span></span><span style="display:flex;"><span>kpt1 <span style="color:#7a8478">=</span> <span style="color:#b2c98f">b</span><span style="color:#b2c98f">&#39;b&#39;</span>
</span></span><span style="display:flex;"><span>kpt2 <span style="color:#7a8478">=</span> <span style="color:#b2c98f">b</span><span style="color:#b2c98f">&#39;r&#39;</span>
</span></span><span style="display:flex;"><span>kpt1bis <span style="color:#7a8478">=</span> <span style="color:#b2c98f">b</span><span style="color:#b2c98f">&#39;c&#39;</span>
</span></span><span style="display:flex;"><span>kpt2bis <span style="color:#7a8478">=</span> <span style="color:#b2c98f">b</span><span style="color:#b2c98f">&#39;k&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>kpt3 <span style="color:#7a8478">=</span> <span style="color:#b2c98f">b</span><span style="color:#b2c98f">&#39;br&#39;</span> 
</span></span><span style="display:flex;"><span>kpt4 <span style="color:#7a8478">=</span> <span style="color:#b2c98f">b</span><span style="color:#b2c98f">&#39;ck&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context<span style="color:#7a8478">.</span>log_level <span style="color:#7a8478">=</span> <span style="color:#b2c98f">&#39;critical&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#d699b6">print</span>(<span style="color:#b2c98f">&#34;[+] Début du brute force de fou bz&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#d699b6">print</span>(<span style="color:#b2c98f">&#34;[+] Sanity check&#34;</span>)
</span></span><span style="display:flex;"><span>conn <span style="color:#7a8478">=</span> remote(host, port)
</span></span><span style="display:flex;"><span><span style="color:#d699b6">print</span>(conn<span style="color:#7a8478">.</span>recv())
</span></span><span style="display:flex;"><span>conn<span style="color:#7a8478">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e67e80">while</span> <span style="color:#7a8478">not</span> flag:
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    conn <span style="color:#7a8478">=</span> remote(host, port)
</span></span><span style="display:flex;"><span>    ciphertext <span style="color:#7a8478">=</span> conn<span style="color:#7a8478">.</span>recvS()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    key1 <span style="color:#7a8478">=</span> xor(ciphertext[<span style="color:#d699b6">0</span>], kpt1)
</span></span><span style="display:flex;"><span>    key2 <span style="color:#7a8478">=</span> xor(ciphertext[<span style="color:#d699b6">1</span>], kpt2)
</span></span><span style="display:flex;"><span>    key1bis <span style="color:#7a8478">=</span> xor(ciphertext[<span style="color:#d699b6">2</span>], kpt1bis)
</span></span><span style="display:flex;"><span>    key2bis <span style="color:#7a8478">=</span> xor(ciphertext[<span style="color:#d699b6">3</span>], kpt2bis)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    key3 <span style="color:#7a8478">=</span> xor(ciphertext[<span style="color:#d699b6">0</span>:<span style="color:#d699b6">2</span>], kpt3)
</span></span><span style="display:flex;"><span>    key4 <span style="color:#7a8478">=</span> xor(ciphertext[<span style="color:#d699b6">2</span>:<span style="color:#d699b6">4</span>], kpt4)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e67e80">if</span> key1 <span style="color:#7a8478">==</span> key2 <span style="color:#7a8478">and</span> key1bis <span style="color:#7a8478">==</span> key2bis:
</span></span><span style="display:flex;"><span>        <span style="color:#d699b6">print</span>(<span style="color:#b2c98f">f</span><span style="color:#b2c98f">&#34;[+] Clé de taille 1 trouvée: </span><span style="color:#b2c98f">{</span>key1<span style="color:#7a8478">.</span>hex()<span style="color:#b2c98f">}</span><span style="color:#b2c98f">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#d699b6">print</span>(<span style="color:#b2c98f">f</span><span style="color:#b2c98f">&#34;[+] Ciphertext: </span><span style="color:#b2c98f">{</span>ciphertext<span style="color:#7a8478">.</span>hex()<span style="color:#b2c98f">}</span><span style="color:#b2c98f">&#34;</span>)
</span></span><span style="display:flex;"><span>        flag <span style="color:#7a8478">=</span> xor(ciphertext, key1)
</span></span><span style="display:flex;"><span>        <span style="color:#d699b6">print</span>(<span style="color:#b2c98f">f</span><span style="color:#b2c98f">&#34;[+] Flag: </span><span style="color:#b2c98f">{</span>flag<span style="color:#b2c98f">}</span><span style="color:#b2c98f">&#34;</span>)
</span></span><span style="display:flex;"><span>        conn<span style="color:#7a8478">.</span>close()
</span></span><span style="display:flex;"><span>        <span style="color:#e67e80">break</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#e67e80">if</span> key3 <span style="color:#7a8478">==</span> key4:
</span></span><span style="display:flex;"><span>        <span style="color:#d699b6">print</span>(<span style="color:#b2c98f">f</span><span style="color:#b2c98f">&#34;[+] Clé de taille 2 trouvée: </span><span style="color:#b2c98f">{</span>key1<span style="color:#7a8478">.</span>hex()<span style="color:#b2c98f">}</span><span style="color:#b2c98f">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#d699b6">print</span>(<span style="color:#b2c98f">f</span><span style="color:#b2c98f">&#34;[+] Ciphertext: </span><span style="color:#b2c98f">{</span>ciphertext<span style="color:#7a8478">.</span>hex()<span style="color:#b2c98f">}</span><span style="color:#b2c98f">&#34;</span>)
</span></span><span style="display:flex;"><span>        flag <span style="color:#7a8478">=</span> xor(ciphertext, key3)
</span></span><span style="display:flex;"><span>        <span style="color:#d699b6">print</span>(<span style="color:#b2c98f">f</span><span style="color:#b2c98f">&#34;[+] Flag: </span><span style="color:#b2c98f">{</span>flag<span style="color:#b2c98f">}</span><span style="color:#b2c98f">&#34;</span>)
</span></span><span style="display:flex;"><span>        conn<span style="color:#7a8478">.</span>close()
</span></span><span style="display:flex;"><span>        <span style="color:#e67e80">break</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    conn<span style="color:#7a8478">.</span>close()
</span></span></code></pre></td></tr></table>
</div>
</div><p>Flag: <code>brck{SiMPl1c1Ty_1s_K3Y_But_N0t_th3_4nSW3r}</code></p>
</article>

            </div>
        </main>

  
    </body>
</html>
